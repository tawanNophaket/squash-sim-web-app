<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Squash Ball Striker Simulation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/3.0.1/chartjs-plugin-annotation.min.js" xintegrity="sha512-H0P9NzU6GfNxHShL3gD6cG3rL6sAYECyOIBG3s/E3W3sD/FhHw93zS/LCEr3eSsKOTUvNBSS8LwQCTh62Rz3gA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div id="custom-message-box" class="message-box-hidden">
        <div class="message-box-content">
            <span id="message-box-icon"></span>
            <p id="message-box-text"></p>
            <button id="message-box-close-btn">Close</button>
        </div>
    </div>

    <div class="container">
        <h1>Squash Ball Striker Simulation</h1>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('basic')"><i class="fas fa-cogs tab-icon"></i>Basic Settings</button>
            <button class="tab-btn" onclick="openTab('advanced')"><i class="fas fa-atom tab-icon"></i>Advanced Physics</button>
            <button class="tab-btn" onclick="openTab('field')"><i class="fas fa-map-marked-alt tab-icon"></i>Field Setup</button>
            <button class="tab-btn" onclick="openTab('results')"><i class="fas fa-clipboard-check tab-icon"></i>Results</button>
        </div>
        
        <div id="basic" class="tab-content active">
            <div class="settings-panel">
                <h2>Striker Settings</h2>
                
                <div class="setting">
                    <label for="release-height">Release Height (m):</label>
                    <select id="release-height">
                        <option value="1.0">1.0</option>
                        <option value="1.5">1.5</option>
                        <option value="2.0" selected>2.0</option>
                    </select>
                </div>
                
                <div class="setting">
                    <label for="strike-height">Strike Height (m):</label>
                    <input type="range" id="strike-height" min="0.01" max="0.5" step="0.01" value="0.35">
                    <span id="height-value">0.35 m</span>
                </div>
                
                <div class="setting">
                    <label for="strike-angle">Strike Angle (°):</label>
                    <input type="range" id="strike-angle" min="10" max="80" step="0.1" value="45">
                    <span id="angle-value">45.0°</span>
                </div>
                
                <div class="setting">
                    <label for="strike-velocity">Strike Velocity (m/s):</label>
                    <input type="range" id="strike-velocity" min="1" max="20" step="0.1" value="5.25">
                    <span id="velocity-value">5.25 m/s</span>
                </div>
                
                <div class="setting-checkbox">
                    <input type="checkbox" id="ideal-comparison">
                    <label for="ideal-comparison">Show Ideal vs. Realistic Comparison</label>
                </div>
                
                <button id="start-btn" class="primary-btn" onclick="startSimulation()">Start Simulation</button>
                <button id="reset-btn" onclick="resetSimulation()">Reset</button>
            </div>
            
            <div class="target-panel">
                <h2>Target Optimization</h2>
                
                <div class="setting">
                    <label for="target-distance">Target Distance (m):</label>
                    <input type="range" id="target-distance" min="0.75" max="2.65" step="0.01" value="1.7">
                    <span id="target-value">1.70 m</span>
                </div>
                
                <div class="target-zone-indicator">
                    <span>Target Zone: </span>
                    <span id="indicator-zone" class="zone-badge">Zone 3</span>
                </div>
                
                <button id="optimize-btn" class="primary-btn" onclick="optimizeSettings()">Find Optimal Settings</button>

                <div id="optimal-angle-tolerance-display" class="optimization-result-display" style="display: none;">
                    <h4>Optimal Settings Applied:</h4>
                    <p><strong>Optimal Angle:</strong> <span id="optimized-angle-value"></span></p>
                    <p><strong>Angle Tolerance (±5%):</strong> <span id="optimized-angle-tolerance-range"></span></p>
                    <p><strong>Optimal Velocity:</strong> <span id="optimized-velocity-value"></span></p>
                </div>
            </div>
        </div>
        
        <div id="advanced" class="tab-content">
            <h2>Advanced Physics Settings</h2>
            
            <div class="settings-panel">
                <div class="setting">
                    <label for="gravity">Gravity (m/s²):</label>
                    <input type="number" id="gravity" min="1" max="20" step="0.01" value="9.81">
                </div>
                
                <div class="setting">
                    <label for="ball-mass">Ball Mass (kg):</label>
                    <input type="number" id="ball-mass" min="0.01" max="0.1" step="0.001" value="0.024">
                </div>
                
                <div class="setting">
                    <label for="air-density">Air Density (kg/m³):</label>
                    <input type="number" id="air-density" min="0.1" max="5" step="0.001" value="1.225">
                </div>
                
                <div class="setting">
                    <label for="drag-coefficient">Drag Coefficient:</label>
                    <input type="number" id="drag-coefficient" min="0.1" max="2" step="0.01" value="0.5">
                </div>
                
                <div class="setting">
                    <label for="elasticity">Elasticity:</label>
                    <input type="number" id="elasticity" min="0.1" max="1" step="0.01" value="0.4">
                </div>
                
                <div class="physics-explanation">
                    <h3>Physics Explanation</h3>
                    <p><strong>Air Density:</strong> Standard air density at sea level is 1.225 kg/m³. Lower values represent thinner air (higher altitude).</p>
                    <p><strong>Drag Coefficient:</strong> Represents the aerodynamic drag of the ball. Higher values create more air resistance.</p>
                    <p><strong>Elasticity:</strong> The coefficient of restitution, representing how much energy is conserved when the ball bounces.</p>
                </div>
            </div>
        </div>
        
        <div id="field" class="tab-content">
            <div class="field-layout-container">
                <div class="field-settings-column">
                    <h2>Field Configuration</h2>
                    <div class="settings-panel">
                        <div class="setting">
                            <label for="field-type">Field Type:</label>
                            <select id="field-type" onchange="handleFieldTypeChange()">
                                <option value="standard" selected>Standard</option>
                                <option value="extra1">Extra 1 (Extended Range)</option>
                                <option value="extra2">Extra 2 (Angle Features)</option>
                                <option value="custom">Custom</option>
                            </select>
                        </div>
                        
                        <div class="field-dimensions">
                            <p class="field-dimensions-title">Current Field Dimensions:</p>
                            <div class="setting">
                                <label for="min-distance">Min Distance (m):</label>
                                <input type="number" id="min-distance" min="0.1" max="10" step="0.01" value="0.75" disabled>
                            </div>
                            
                            <div class="setting">
                                <label for="max-distance">Max Distance (m):</label>
                                <input type="number" id="max-distance" min="0.1" max="10" step="0.01" value="2.65" disabled>
                            </div>
                            
                            <div class="setting">
                                <label for="zone-width">Avg. Zone Width (m):</label>
                                <input type="number" id="zone-width" min="0.1" max="2" step="0.01" value="0.38" disabled>
                            </div>
                        </div>
                        
                        <div class="field-actions">
                            <button id="apply-field-btn" onclick="applyFieldSettings()" disabled>Apply Custom Settings</button>
                            <button id="test-zones-btn" class="secondary-btn" onclick="testAllZones()">Test All Zones</button>
                        </div>
                    </div>
                </div>

                <div class="field-visualization-column">
                    <h3>Field Zone Layout</h3>
                    <div class="field-visualization">
                        <canvas id="field-chart"></canvas>
                        <div id="field-info-text" class="field-info-text">
                            <p><strong>Robot Area:</strong> 0.0m - 0.5m (approx.)</p>
                            <p><strong>Release Point:</strong> At 0.0m distance.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="results" class="tab-content">
            <h2>Simulation Results</h2>
            
            <div class="results-panel">
                <div class="result-item">
                    <span class="label">Landing Distance:</span>
                    <span id="landing-distance" class="value">0.00 m</span>
                </div>
                
                <div class="result-item">
                    <span class="label">Target Zone:</span>
                    <span id="target-zone" class="value">None</span>
                </div>
                
                <div class="result-item">
                    <span class="label">Strike Time:</span>
                    <span id="strike-time" class="value">0.00 s</span>
                </div>
                
                <div class="result-item ideal-result">
                    <span class="label">Ideal Landing:</span>
                    <span id="ideal-landing" class="value">0.00 m</span>
                </div>
                
                <div class="result-item ideal-result">
                    <span class="label">Difference:</span>
                    <span id="landing-difference" class="value">0.00 m</span>
                </div>
            </div>
            
            <canvas id="trajectory-chart"></canvas>
            
            <div id="test-zone-results"></div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
